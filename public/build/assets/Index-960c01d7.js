import{p as R,a2 as M,I as T,L as N,o as s,c as x,w as m,D as k,b as l,u as i,i as S,f as w,a,k as F,e as r,g as u,t as c,F as f,ai as P,n as b,h as p}from"./app-e23bdcff.js";import{_ as W}from"./AppLayout-1872c1d6.js";import{_ as I}from"./PrimaryButton-53fc1b09.js";import{_ as z}from"./SecondaryButton-4187b912.js";import{a as G}from"./DialogModal-ba4ec678.js";import{_ as $}from"./TextInput-67026b5f.js";import{r as C,a as A,e as K,m as V,u as Z}from"./i18n-validators-63d8612e.js";import{_}from"./InputLabel-8586db4c.js";import{_ as U}from"./Checkbox-4f738b6a.js";import{_ as j}from"./CustomButton-9f2275fd.js";const H=a("div",{class:"flex flex-row"},[a("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Usuarios del sistema ")],-1),J={class:"py-10"},Q={class:"max-w-8xl sm:px-4 lg:px-6"},X={class:"text-center flex flex-row"},Y={class:"badge badge-success"},ee={class:"badge badge-success"},se={class:"badge badge-success"},oe={class:"mt-4"},re=a("option",{disabled:"",selected:"",value:""},"Seleccione…",-1),te=a("option",{value:"customer"},"Cliente",-1),ae=a("option",{value:"designer"},"Diseñador",-1),le=[re,te,ae],ie={class:"mt-4"},ne={key:0,class:"mt-1"},de={class:"mt-4"},me={key:0,class:"mt-1"},ce={class:"mt-4"},ue={key:0,class:"mt-1"},fe={key:0,class:"block mt-4"},pe={class:"flex items-center"},_e=a("span",{class:"ml-2 text-sm text-gray-600"},"Cambiar contraseña",-1),he={key:1,class:"mt-4"},ge={key:0,class:"mt-1"},ve={class:"mt-4"},ye={class:"grid grid-cols-3 gap-5 mt-2"},xe={class:"flex items-center"},ke={class:"ml-2"},we={key:0,class:"mt-1"},be={class:"mt-4"},$e={class:"grid grid-cols-3 gap-5 mt-2"},Ce={class:"flex items-center"},Ve={class:"ml-2"},Ue={key:0,class:"mt-1"},qe={class:"mt-4"},Ee={class:"grid grid-cols-3 gap-5 mt-2"},Se={class:"flex items-center"},Ae={class:"ml-2"},Re={key:0,class:"mt-1"},ze={__name:"Index",props:{users:{type:Array,default:[]},roles:{type:Array,default:[]},permissions:{type:Array,default:[]},reports:{type:Array,default:[]}},setup(y){const g=R({data:y.users,columns:["actions","name","username","email","roles","permissions","reports","created_at","updated_at"],options:{headings:{actions:"",name:"NOMBRE",username:"USUARIO",email:"CORREO ELECTRÓNICO",roles:"ROLES",permissions:"PERMISOS",reports:"REPORTES",created_at:"CREADO EL",updated_at:"ACTUALIZADO EL"},clientSorting:!1,uniqueKey:"id",sortable:["name","username","email"]}}),o=R({open:!1,editMode:!1,title:"",form:{id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",reports:[],permissions:[],roles:[]}}),L={form:{id:{requiredIf:C(o.editMode)},name:{required:A},username:{required:A},email:{required:A,email:K},password:{requiredIf:C(o.form.change_password||!o.editMode),minLength:V(8)},reports:{minLength:V(1)},permissions:{requiredIf:C(o.form.roles.length<1),minLength:V(1)},roles:{requiredIf:C(o.form.permissions.length<1),minLength:V(1)}}},n=Z(L,M(o)),B=()=>{o.open=!0,o.title="Crear Usuario"},q=()=>{o.open=!1,o.title="",o.form={id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",reports:[],permissions:[],roles:[]},n.value.form.$reset()},O=()=>{n.value.form.$touch(),n.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.post(route("users.store"),o.form).then(h=>{q(),g.data=h.data}).catch(h=>{Swal.fire({icon:"error",title:"¡Whoops!",text:h.response.data,confirmButtonText:"Aceptar"})})},D=h=>{Swal.fire({icon:"question",title:"¿Eliminar Usuario?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(d=>{d.isConfirmed&&axios.delete(route("users.destroy",h)).then(v=>{g.data=v.data}).catch(v=>{Swal.fire({icon:"error",title:"¡Whoops!",text:v.response.data,confirmButtonText:"Aceptar"})})})};return(h,d)=>{const v=T("v-client-table"),E=N("permission");return s(),x(W,{title:"Usuarios del sistema"},{header:m(()=>[H]),actions:m(()=>[k((s(),x(I,{class:"ml-auto",type:"button",onClick:B},{default:m(()=>[l(i(S),{class:"mr-2",icon:"plus"}),w(" Crear ")]),_:1})),[[E,"user.create"]])]),default:m(()=>[a("div",J,[a("div",Q,[l(v,{columns:g.columns,data:g.data,options:g.options,class:"overflow-y-auto"},{actions:m(({row:e})=>[a("div",X,[k((s(),x(i(F),{href:h.route("users.show",e.id),class:"mr-2 inline-flex items-center px-2 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},{default:m(()=>[l(i(S),{icon:["far","pen-to-square"]})]),_:2},1032,["href"])),[[E,"user.edit"]]),k((s(),x(j,{onClick:t=>D(e.id)},{default:m(()=>[l(i(S),{icon:["far","trash-can"]})]),_:2},1032,["onClick"])),[[E,"user.destroy"]])])]),roles:m(({row:e})=>[(s(!0),r(f,null,u(e.roles,t=>(s(),r("span",Y,c(t.name),1))),256))]),permissions:m(({row:e})=>[(s(!0),r(f,null,u(e.permission_names,t=>(s(),r("span",ee,c(t),1))),256))]),reports:m(({row:e})=>[(s(!0),r(f,null,u(e.reports,t=>(s(),r("span",se,c(t.name),1))),256))]),_:1},8,["columns","data","options"])])]),l(G,{show:o.open,onClose:q},{title:m(()=>[w(c(o.title),1)]),content:m(()=>[a("div",oe,[l(_,{value:"Tipo"}),k(a("select",{"onUpdate:modelValue":d[0]||(d[0]=e=>o.form.type=e),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full",required:""},le,512),[[P,o.form.type]])]),a("div",ie,[l(_,{value:"Nombre"}),l($,{modelValue:o.form.name,"onUpdate:modelValue":d[1]||(d[1]=e=>o.form.name=e),class:b([{"border-red-500":i(n).form.name.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"text"},null,8,["modelValue","class"]),i(n).form.name.$error?(s(),r("ul",ne,[(s(!0),r(f,null,u(i(n).form.name.$errors,(e,t)=>(s(),r("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",de,[l(_,{value:"Usuario"}),l($,{modelValue:o.form.username,"onUpdate:modelValue":d[2]||(d[2]=e=>o.form.username=e),class:b([{"border-red-500":i(n).form.username.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"text"},null,8,["modelValue","class"]),i(n).form.username.$error?(s(),r("ul",me,[(s(!0),r(f,null,u(i(n).form.username.$errors,(e,t)=>(s(),r("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",ce,[l(_,{value:"Correo electrónico"}),l($,{modelValue:o.form.email,"onUpdate:modelValue":d[3]||(d[3]=e=>o.form.email=e),class:b([{"border-red-500":i(n).form.email.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"email"},null,8,["modelValue","class"]),i(n).form.email.$error?(s(),r("ul",ue,[(s(!0),r(f,null,u(i(n).form.email.$errors,(e,t)=>(s(),r("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),o.editMode?(s(),r("div",fe,[a("label",pe,[l(U,{checked:o.form.change_password,"onUpdate:checked":d[4]||(d[4]=e=>o.form.change_password=e),name:"change_password"},null,8,["checked"]),_e])])):p("",!0),o.form.change_password||!o.editMode?(s(),r("div",he,[l(_,{value:"Contraseña"}),l($,{modelValue:o.form.password,"onUpdate:modelValue":d[5]||(d[5]=e=>o.form.password=e),class:b([{"border-red-500":i(n).form.password.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"password"},null,8,["modelValue","class"]),i(n).form.password.$error?(s(),r("ul",ge,[(s(!0),r(f,null,u(i(n).form.password.$errors,(e,t)=>(s(),r("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)])):p("",!0),a("div",ve,[l(_,{value:"Reportes disponibles"}),a("div",ye,[(s(!0),r(f,null,u(y.reports,e=>(s(),r("div",xe,[l(U,{checked:o.form.reports,"onUpdate:checked":d[6]||(d[6]=t=>o.form.reports=t),value:e.id},null,8,["checked","value"]),a("div",ke,c(e.name),1)]))),256))]),i(n).form.reports.$error?(s(),r("ul",we,[(s(!0),r(f,null,u(i(n).form.reports.$errors,(e,t)=>(s(),r("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",be,[l(_,{value:"Roles Disponibles"}),a("div",$e,[(s(!0),r(f,null,u(y.roles,e=>(s(),r("div",Ce,[l(U,{checked:o.form.roles,"onUpdate:checked":d[7]||(d[7]=t=>o.form.roles=t),value:e.name},null,8,["checked","value"]),a("div",Ve,c(e.name),1)]))),256))]),i(n).form.roles.$error?(s(),r("ul",Ue,[(s(!0),r(f,null,u(i(n).form.roles.$errors,(e,t)=>(s(),r("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",qe,[l(_,{value:"Permisos Disponibles"}),a("div",Ee,[(s(!0),r(f,null,u(y.permissions,e=>(s(),r("div",Se,[l(U,{checked:o.form.permissions,"onUpdate:checked":d[8]||(d[8]=t=>o.form.permissions=t),value:e.name},null,8,["checked","value"]),a("div",Ae,c(e.name),1)]))),256))]),i(n).form.permissions.$error?(s(),r("ul",Re,[(s(!0),r(f,null,u(i(n).form.permissions.$errors,(e,t)=>(s(),r("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)])]),footer:m(()=>[l(z,{onClick:q},{default:m(()=>[w(" Cancelar ")]),_:1}),l(I,{class:"ml-3",onClick:O},{default:m(()=>[w(" Guardar ")]),_:1})]),_:1},8,["show"])]),_:1})}}};export{ze as default};
