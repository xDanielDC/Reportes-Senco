import{_ as N}from"./AppLayout-deca06e6.js";import{_ as g}from"./PrimaryButton-9f83ec13.js";import{_ as I}from"./SecondaryButton-641ff84c.js";import{a as O}from"./DialogModal-cfec345b.js";import{_ as W}from"./TextInput-c4d1940e.js";import{r as F,a as w,m as U,u as z}from"./i18n-validators-bc3fab5c.js";import{_ as A}from"./InputLabel-7ab20a25.js";import{_ as P}from"./Checkbox-41e6bf30.js";import{_ as B}from"./CustomButton-4ddc4f19.js";import{p as S,a6 as E,a3 as G,L as H,O as K,o as s,c as f,w as a,a as c,H as y,b as n,u as d,i as C,f as _,e as l,g as h,t as x,F as $,n as Z,h as R}from"./app-8631d0ed.js";const j={class:"py-10"},J={class:"max-w-8xl sm:px-4 lg:px-6"},Q={class:"text-center flex flex-row"},X={class:"badge badge-success"},Y={class:"mt-4"},ee={key:0,class:"mt-1"},te={class:"mt-4"},oe={class:"grid grid-cols-3 gap-5 mt-2"},se={class:"flex items-center"},ae={class:"ml-2"},re={key:0,class:"mt-1"},he={__name:"Roles",props:{roles:{type:Array,default:[]},permissions:{type:Array,default:[]}},setup(b){const u=S({data:b.roles,columns:["actions","name","permissions","created_at","updated_at"],options:{headings:{actions:"",name:"NOMBRE",permissions:"PERMISOS",created_at:"CREADO EL",updated_at:"ACTUALIZADO EL"},clientSorting:!1,uniqueKey:"id",sortable:["description"],templates:{created_at(o,t){return E.formatDate(t.created_at)},updated_at(o,t){return E.formatDate(t.updated_at)}}}}),e=S({open:!1,editMode:!1,title:"",form:{id:"",name:"",permissions:[]}}),V={form:{id:{requiredIf:F(e.editMode)},name:{required:w},permissions:{required:w,minLength:U(1)}}},i=z(V,G(e)),q=()=>{e.open=!0,e.title="Crear Rol"},D=o=>{e.open=!0,e.editMode=!0,e.title="Editar Rol",e.form={id:o.id,name:o.name,permissions:o.permissions.map(t=>t.name)}},v=()=>{e.open=!1,e.editMode=!1,e.title="",e.form={id:"",name:"",permissions:[]},i.value.form.$reset()},M=()=>{i.value.form.$touch(),i.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.post(route("roles.store"),e.form).then(o=>{v(),u.data=o.data}).catch(o=>{Swal.fire({icon:"error",title:"¡Whoops!",text:o.response.data,confirmButtonText:"Aceptar"})})},T=()=>{i.value.form.$touch(),i.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.put(route("roles.update",e.form.id),e.form).then(o=>{v(),u.data=o.data}).catch(o=>{Swal.fire({icon:"error",title:"¡Whoops!",text:o.response.data,confirmButtonText:"Aceptar"})})},L=o=>{Swal.fire({icon:"question",title:"¿Eliminar Rol?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(t=>{t.isConfirmed&&axios.delete(route("roles.destroy",o)).then(p=>{u.data=p.data}).catch(p=>{Swal.fire({icon:"error",title:"¡Whoops!",text:p.response.data,confirmButtonText:"Aceptar"})})})};return(o,t)=>{const p=H("v-client-table"),k=K("permission");return s(),f(N,{title:"Roles"},{header:a(()=>[...t[2]||(t[2]=[c("div",{class:"flex flex-row"},[c("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Roles ")],-1)])]),actions:a(()=>[y((s(),f(g,{type:"button",onClick:q},{default:a(()=>[n(d(C),{class:"mr-2",icon:"plus"}),t[3]||(t[3]=_(" Crear ",-1))]),_:1})),[[k,"role.create"]])]),default:a(()=>[c("div",j,[c("div",J,[n(p,{columns:u.columns,data:u.data,options:u.options,class:"overflow-y-auto"},{actions:a(({row:r})=>[c("div",Q,[y((s(),f(B,{class:"mr-2",onClick:m=>D(r)},{default:a(()=>[n(d(C),{icon:["far","pen-to-square"]})]),_:1},8,["onClick"])),[[k,"role.edit"]]),y((s(),f(B,{onClick:m=>L(r.id)},{default:a(()=>[n(d(C),{icon:["far","trash-can"]})]),_:1},8,["onClick"])),[[k,"role.destroy"]])])]),permissions:a(({row:r})=>[(s(!0),l($,null,h(r.permissions,(m,ne)=>(s(),l("span",X,x(m.name),1))),256))]),_:1},8,["columns","data","options"])])]),n(O,{show:e.open,onClose:v},{title:a(()=>[_(x(e.title),1)]),content:a(()=>[c("div",Y,[n(A,{value:"Nombre"}),n(W,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.name=r),class:Z([{"border-red-500":d(i).form.name.$error},"mt-1 block w-full"]),autocomplete:"Nombre",required:"",type:"text"},null,8,["modelValue","class"]),d(i).form.name.$error?(s(),l("ul",ee,[(s(!0),l($,null,h(d(i).form.name.$errors,(r,m)=>(s(),l("li",{key:m,class:"text-red-500"},x(r.$message),1))),128))])):R("",!0)]),c("div",te,[n(A,{value:"Permisos Disponibles"}),c("div",oe,[(s(!0),l($,null,h(b.permissions,r=>(s(),l("div",se,[n(P,{checked:e.form.permissions,"onUpdate:checked":t[1]||(t[1]=m=>e.form.permissions=m),value:r.name},null,8,["checked","value"]),c("div",ae,x(r.name),1)]))),256))]),d(i).form.permissions.$error?(s(),l("ul",re,[(s(!0),l($,null,h(d(i).form.permissions.$errors,(r,m)=>(s(),l("li",{key:m,class:"text-red-500"},x(r.$message),1))),128))])):R("",!0)])]),footer:a(()=>[n(I,{onClick:v},{default:a(()=>[...t[4]||(t[4]=[_(" Cancelar ",-1)])]),_:1}),e.editMode?(s(),f(g,{key:0,class:"ml-3",onClick:T},{default:a(()=>[...t[5]||(t[5]=[_(" Actualizar ",-1)])]),_:1})):(s(),f(g,{key:1,class:"ml-3",onClick:M},{default:a(()=>[...t[6]||(t[6]=[_(" Guardar ",-1)])]),_:1}))]),_:1},8,["show"])]),_:1})}}};export{he as default};
