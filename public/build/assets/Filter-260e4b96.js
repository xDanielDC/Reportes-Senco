import{_ as L}from"./AppLayout-deca06e6.js";import{_ as w}from"./PrimaryButton-9f83ec13.js";import{_ as v}from"./TextInput-c4d1940e.js";import{p as A,a3 as U,L as D,O as W,o as r,c as f,w as m,a as u,H as q,b as i,u as l,i as B,f as x,t as p,n as $,e as n,F as b,g as k,h as y}from"./app-8631d0ed.js";import{_ as E}from"./CustomButton-4ddc4f19.js";import{_ as I}from"./SecondaryButton-641ff84c.js";import{_ as V}from"./InputLabel-7ab20a25.js";import{a as z}from"./DialogModal-cfec345b.js";import{r as G,a as C,u as H}from"./i18n-validators-bc3fab5c.js";const K={class:"py-10"},P={class:"max-w-8xl sm:px-4 lg:px-6"},j={class:"text-center flex flex-row"},J={class:"mt-4"},Q={key:0,class:"mt-1"},X={class:"mt-4"},Y={key:0,class:"mt-1"},Z={class:"mt-4"},ee={key:0,class:"mt-1"},te={class:"mt-4"},oe={key:0,class:"mt-1"},re={class:"mt-4"},ae={key:0,class:"mt-1"},_e={__name:"Filter",props:{filters:{type:Array,default:[]}},setup(S){const c=A({data:S.filters,columns:["actions","name","table","column","operator","values","created_at"],options:{headings:{actions:"",name:"NOMBRE",table:"TABLA",column:"COLUMNA",operator:"OPERADOR",values:"VALOR",created_at:"CREADO EL"},clientSorting:!1,uniqueKey:"id",sortable:["name","table","column","operator"]}}),e=A({open:!1,editMode:!1,title:"",form:{id:"",name:"",table:"",column:"",operator:"",values:""}}),T=A({form:{id:{requiredIf:G(e.editMode)},name:{required:C},table:{required:C},column:{required:C},operator:{required:C},values:{required:C}}}),a=H(T,U(e)),F=()=>{e.open=!0,e.title="Crear Filtro"},M=s=>{e.open=!0,e.editMode=!0,e.title="Editar Filtro",e.form={id:s.id,name:s.name,group_id:s.group_id,report_id:s.report_id,dataset_id:s.dataset_id}},g=()=>{e.open=!1,e.editMode=!1,e.title="",e.form={id:"",name:"",group_id:"",report_id:"",dataset_id:""},a.value.form.$reset()},O=()=>{a.value.form.$touch(),a.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.post(route("report.filter.store"),e.form).then(s=>{g(),c.data=s.data}).catch(s=>{Swal.fire({icon:"error",title:"¡Whoops!",text:s.response.data,confirmButtonText:"Aceptar"})})},N=()=>{a.value.form.$touch(),a.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.put(route("report.filter.update",e.form.id),e.form).then(s=>{g(),c.data=s.data}).catch(s=>{Swal.fire({icon:"error",title:"¡Whoops!",text:s.response.data,confirmButtonText:"Aceptar"})})},R=s=>{Swal.fire({icon:"question",title:"¿Eliminar Reporte?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(t=>{t.isConfirmed&&axios.delete(route("report.filter.destroy",s)).then(_=>{c.data=_.data}).catch(_=>{Swal.fire({icon:"error",title:"¡Whoops!",text:_.response.data,confirmButtonText:"Aceptar"})})})};return(s,t)=>{const _=D("v-client-table"),h=W("permission");return r(),f(L,{title:"Filtros"},{header:m(()=>[...t[5]||(t[5]=[u("div",{class:"flex flex-row"},[u("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Filtros ")],-1)])]),actions:m(()=>[q((r(),f(w,{type:"button",class:"ml-auto",onClick:F},{default:m(()=>[i(l(B),{icon:"plus",class:"mr-2"}),t[6]||(t[6]=x(" Crear ",-1))]),_:1})),[[h,"report.filter.create"]])]),default:m(()=>[u("div",K,[u("div",P,[i(_,{columns:c.columns,data:c.data,options:c.options,class:"overflow-y-auto"},{actions:m(({row:o})=>[u("div",j,[q((r(),f(E,{class:"mr-2",onClick:d=>M(o)},{default:m(()=>[i(l(B),{icon:["far","pen-to-square"]})]),_:1},8,["onClick"])),[[h,"report.filter.update"]]),q((r(),f(E,{onClick:d=>R(o.id)},{default:m(()=>[i(l(B),{icon:["far","trash-can"]})]),_:1},8,["onClick"])),[[h,"report.filter.destroy"]])])]),_:1},8,["columns","data","options"])])]),i(z,{show:e.open,onClose:g},{title:m(()=>[x(p(e.title),1)]),content:m(()=>[u("div",J,[i(V,{value:"Nombre"}),i(v,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=o=>e.form.name=o),type:"text",class:$(["mt-1 block w-full",{"border-red-500":l(a).form.name.$error}]),required:""},null,8,["modelValue","class"]),l(a).form.name.$error?(r(),n("ul",Q,[(r(!0),n(b,null,k(l(a).form.name.$errors,(o,d)=>(r(),n("li",{class:"text-red-500",key:d},p(o.$message),1))),128))])):y("",!0)]),u("div",X,[i(V,{value:"Tabla"}),i(v,{modelValue:e.form.table,"onUpdate:modelValue":t[1]||(t[1]=o=>e.form.table=o),type:"text",class:$(["mt-1 block w-full",{"border-red-500":l(a).form.table.$error}]),required:""},null,8,["modelValue","class"]),l(a).form.table.$error?(r(),n("ul",Y,[(r(!0),n(b,null,k(l(a).form.table.$errors,(o,d)=>(r(),n("li",{class:"text-red-500",key:d},p(o.$message),1))),128))])):y("",!0)]),u("div",Z,[i(V,{value:"Columna"}),i(v,{modelValue:e.form.column,"onUpdate:modelValue":t[2]||(t[2]=o=>e.form.column=o),type:"text",class:$(["mt-1 block w-full",{"border-red-500":l(a).form.column.$error}]),required:""},null,8,["modelValue","class"]),l(a).form.column.$error?(r(),n("ul",ee,[(r(!0),n(b,null,k(l(a).form.column.$errors,(o,d)=>(r(),n("li",{class:"text-red-500",key:d},p(o.$message),1))),128))])):y("",!0)]),u("div",te,[i(V,{value:"Operador"}),i(v,{modelValue:e.form.operator,"onUpdate:modelValue":t[3]||(t[3]=o=>e.form.operator=o),type:"text",class:$(["mt-1 block w-full",{"border-red-500":l(a).form.operator.$error}]),required:""},null,8,["modelValue","class"]),l(a).form.operator.$error?(r(),n("ul",oe,[(r(!0),n(b,null,k(l(a).form.operator.$errors,(o,d)=>(r(),n("li",{class:"text-red-500",key:d},p(o.$message),1))),128))])):y("",!0)]),u("div",re,[i(V,{value:"Valor"}),i(v,{modelValue:e.form.values,"onUpdate:modelValue":t[4]||(t[4]=o=>e.form.values=o),type:"text",class:$(["mt-1 block w-full",{"border-red-500":l(a).form.values.$error}]),required:""},null,8,["modelValue","class"]),l(a).form.values.$error?(r(),n("ul",ae,[(r(!0),n(b,null,k(l(a).form.values.$errors,(o,d)=>(r(),n("li",{class:"text-red-500",key:d},p(o.$message),1))),128))])):y("",!0)])]),footer:m(()=>[i(I,{onClick:g},{default:m(()=>[...t[7]||(t[7]=[x(" Cancelar ",-1)])]),_:1}),e.editMode?(r(),f(w,{key:0,class:"ml-3",onClick:N},{default:m(()=>[...t[8]||(t[8]=[x(" Actualizar ",-1)])]),_:1})):(r(),f(w,{key:1,class:"ml-3",onClick:O},{default:m(()=>[...t[9]||(t[9]=[x(" Guardar ",-1)])]),_:1}))]),_:1},8,["show"])]),_:1})}}};export{_e as default};
