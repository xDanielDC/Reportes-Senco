import{p as I,a2 as D,I as T,L as N,o as s,c as b,w as m,D as C,b as l,u as i,i as E,f as V,a,k as F,e as o,g as f,t as c,F as u,ai as P,n as w,h as p}from"./app-f1fb3b10.js";import{_ as W}from"./AppLayout-ae53a7bb.js";import{_ as L}from"./PrimaryButton-ae7b5b9e.js";import{_ as z}from"./SecondaryButton-f0719638.js";import{a as G}from"./DialogModal-0a95c594.js";import{_ as y}from"./TextInput-ed7a8386.js";import{r as k,a as S,e as K,m as x,s as Z,u as j}from"./i18n-validators-307ee24b.js";import{_}from"./InputLabel-b3778487.js";import{_ as U}from"./Checkbox-19abc708.js";import{_ as H}from"./CustomButton-58efdc54.js";const J=a("div",{class:"flex flex-row"},[a("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Usuarios del sistema ")],-1),Q={class:"py-10"},X={class:"max-w-8xl sm:px-4 lg:px-6"},Y={class:"text-center flex flex-row"},ee={class:"badge badge-success"},se={class:"badge badge-success"},re={class:"badge badge-success"},oe={class:"mt-4"},te=a("option",{disabled:"",selected:"",value:""},"Seleccione…",-1),ae=a("option",{value:"customer"},"Cliente",-1),le=a("option",{value:"designer"},"Diseñador",-1),ie=[te,ae,le],ne={class:"mt-4"},de={key:0,class:"mt-1"},me={class:"mt-4"},ce={key:0,class:"mt-1"},ue={class:"mt-4"},fe={key:0,class:"mt-1"},pe={key:0,class:"block mt-4"},_e={class:"flex items-center"},he=a("span",{class:"ml-2 text-sm text-gray-600"},"Cambiar contraseña",-1),ge={class:"mt-4"},ve={key:0,class:"mt-1"},we={class:"mt-4"},ye={key:0,class:"mt-1"},ke={class:"mt-4"},xe={class:"grid grid-cols-3 gap-5 mt-2"},$e={class:"flex items-center"},be={class:"ml-2"},Ce={key:0,class:"mt-1"},Ve={class:"mt-4"},Ue={class:"grid grid-cols-3 gap-5 mt-2"},qe={class:"flex items-center"},Ae={class:"ml-2"},Ee={key:0,class:"mt-1"},Se={class:"mt-4"},Ie={class:"grid grid-cols-3 gap-5 mt-2"},Le={class:"flex items-center"},Re={class:"ml-2"},Be={key:0,class:"mt-1"},Ze={__name:"Index",props:{users:{type:Array,default:[]},roles:{type:Array,default:[]},permissions:{type:Array,default:[]},reports:{type:Array,default:[]}},setup($){const g=I({data:$.users,columns:["actions","name","username","email","roles","permissions","reports","created_at","updated_at"],options:{headings:{actions:"",name:"NOMBRE",username:"USUARIO",email:"CORREO ELECTRÓNICO",roles:"ROLES",permissions:"PERMISOS",reports:"REPORTES",created_at:"CREADO EL",updated_at:"ACTUALIZADO EL"},clientSorting:!1,uniqueKey:"id",sortable:["name","username","email"]}}),r=I({open:!1,editMode:!1,title:"",form:{id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]}}),R={form:{id:{requiredIf:k(r.editMode)},name:{required:S},username:{required:S},email:{required:S,email:K},password:{requiredIf:k(r.form.change_password||!r.editMode),minLength:x(8)},confirm_password:{requiredIf:k(r.form.change_password||!r.editMode),sameAs:Z(r.form.password),minLength:x(8)},reports:{minLength:x(1)},permissions:{requiredIf:k(r.form.roles.length<1),minLength:x(1)},roles:{requiredIf:k(r.form.permissions.length<1),minLength:x(1)}}},n=j(R,D(r)),B=()=>{r.open=!0,r.title="Crear Usuario"},q=()=>{r.open=!1,r.title="",r.form={id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",confirm_password:"",reports:[],permissions:[],roles:[]},n.value.form.$reset()},M=()=>{n.value.form.$touch(),n.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.post(route("users.store"),r.form).then(h=>{q(),g.data=h.data}).catch(h=>{Swal.fire({icon:"error",title:"¡Whoops!",text:h.response.data,confirmButtonText:"Aceptar"})})},O=h=>{Swal.fire({icon:"question",title:"¿Eliminar Usuario?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(d=>{d.isConfirmed&&axios.delete(route("users.destroy",h)).then(v=>{g.data=v.data}).catch(v=>{Swal.fire({icon:"error",title:"¡Whoops!",text:v.response.data,confirmButtonText:"Aceptar"})})})};return(h,d)=>{const v=T("v-client-table"),A=N("permission");return s(),b(W,{title:"Usuarios del sistema"},{header:m(()=>[J]),actions:m(()=>[C((s(),b(L,{class:"ml-auto",type:"button",onClick:B},{default:m(()=>[l(i(E),{class:"mr-2",icon:"plus"}),V(" Crear ")]),_:1})),[[A,"user.create"]])]),default:m(()=>[a("div",Q,[a("div",X,[l(v,{columns:g.columns,data:g.data,options:g.options,class:"overflow-y-auto"},{actions:m(({row:e})=>[a("div",Y,[C((s(),b(i(F),{href:h.route("users.show",e.id),class:"mr-2 inline-flex items-center px-2 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},{default:m(()=>[l(i(E),{icon:["far","pen-to-square"]})]),_:2},1032,["href"])),[[A,"user.edit"]]),C((s(),b(H,{onClick:t=>O(e.id)},{default:m(()=>[l(i(E),{icon:["far","trash-can"]})]),_:2},1032,["onClick"])),[[A,"user.destroy"]])])]),roles:m(({row:e})=>[(s(!0),o(u,null,f(e.roles,t=>(s(),o("span",ee,c(t.name),1))),256))]),permissions:m(({row:e})=>[(s(!0),o(u,null,f(e.permission_names,t=>(s(),o("span",se,c(t),1))),256))]),reports:m(({row:e})=>[(s(!0),o(u,null,f(e.reports,t=>(s(),o("span",re,c(t.name),1))),256))]),_:1},8,["columns","data","options"])])]),l(G,{show:r.open,onClose:q},{title:m(()=>[V(c(r.title),1)]),content:m(()=>[a("div",oe,[l(_,{value:"Tipo"}),C(a("select",{"onUpdate:modelValue":d[0]||(d[0]=e=>r.form.type=e),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full",required:""},ie,512),[[P,r.form.type]])]),a("div",ne,[l(_,{value:"Nombre"}),l(y,{modelValue:r.form.name,"onUpdate:modelValue":d[1]||(d[1]=e=>r.form.name=e),class:w([{"border-red-500":i(n).form.name.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"text"},null,8,["modelValue","class"]),i(n).form.name.$error?(s(),o("ul",de,[(s(!0),o(u,null,f(i(n).form.name.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",me,[l(_,{value:"Usuario"}),l(y,{modelValue:r.form.username,"onUpdate:modelValue":d[2]||(d[2]=e=>r.form.username=e),class:w([{"border-red-500":i(n).form.username.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"text"},null,8,["modelValue","class"]),i(n).form.username.$error?(s(),o("ul",ce,[(s(!0),o(u,null,f(i(n).form.username.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",ue,[l(_,{value:"Correo electrónico"}),l(y,{modelValue:r.form.email,"onUpdate:modelValue":d[3]||(d[3]=e=>r.form.email=e),class:w([{"border-red-500":i(n).form.email.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"email"},null,8,["modelValue","class"]),i(n).form.email.$error?(s(),o("ul",fe,[(s(!0),o(u,null,f(i(n).form.email.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),r.editMode?(s(),o("div",pe,[a("label",_e,[l(U,{checked:r.form.change_password,"onUpdate:checked":d[4]||(d[4]=e=>r.form.change_password=e),name:"change_password"},null,8,["checked"]),he])])):p("",!0),r.form.change_password||!r.editMode?(s(),o(u,{key:1},[a("div",ge,[l(_,{value:"Contraseña"}),l(y,{modelValue:r.form.password,"onUpdate:modelValue":d[5]||(d[5]=e=>r.form.password=e),class:w([{"border-red-500":i(n).form.password.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"password"},null,8,["modelValue","class"]),i(n).form.password.$error?(s(),o("ul",ve,[(s(!0),o(u,null,f(i(n).form.password.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",we,[l(_,{value:"Confirmar Contraseña"}),l(y,{modelValue:r.form.confirm_password,"onUpdate:modelValue":d[6]||(d[6]=e=>r.form.confirm_password=e),class:w([{"border-red-500":i(n).form.confirm_password.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"password"},null,8,["modelValue","class"]),i(n).form.confirm_password.$error?(s(),o("ul",ye,[(s(!0),o(u,null,f(i(n).form.confirm_password.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)])],64)):p("",!0),a("div",ke,[l(_,{value:"Reportes disponibles"}),a("div",xe,[(s(!0),o(u,null,f($.reports,e=>(s(),o("div",$e,[l(U,{checked:r.form.reports,"onUpdate:checked":d[7]||(d[7]=t=>r.form.reports=t),value:e.id},null,8,["checked","value"]),a("div",be,c(e.name),1)]))),256))]),i(n).form.reports.$error?(s(),o("ul",Ce,[(s(!0),o(u,null,f(i(n).form.reports.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",Ve,[l(_,{value:"Roles Disponibles"}),a("div",Ue,[(s(!0),o(u,null,f($.roles,e=>(s(),o("div",qe,[l(U,{checked:r.form.roles,"onUpdate:checked":d[8]||(d[8]=t=>r.form.roles=t),value:e.name},null,8,["checked","value"]),a("div",Ae,c(e.name),1)]))),256))]),i(n).form.roles.$error?(s(),o("ul",Ee,[(s(!0),o(u,null,f(i(n).form.roles.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)]),a("div",Se,[l(_,{value:"Permisos Disponibles"}),a("div",Ie,[(s(!0),o(u,null,f($.permissions,e=>(s(),o("div",Le,[l(U,{checked:r.form.permissions,"onUpdate:checked":d[9]||(d[9]=t=>r.form.permissions=t),value:e.name},null,8,["checked","value"]),a("div",Re,c(e.name),1)]))),256))]),i(n).form.permissions.$error?(s(),o("ul",Be,[(s(!0),o(u,null,f(i(n).form.permissions.$errors,(e,t)=>(s(),o("li",{key:t,class:"text-red-500"},c(e.$message),1))),128))])):p("",!0)])]),footer:m(()=>[l(z,{onClick:q},{default:m(()=>[V(" Cancelar ")]),_:1}),l(L,{class:"ml-3",onClick:M},{default:m(()=>[V(" Guardar ")]),_:1})]),_:1},8,["show"])]),_:1})}}};export{Ze as default};
