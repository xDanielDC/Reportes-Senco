import{d as g,p as q,o as t,e as r,a as c,r as E,b as n,w as a,f as l,t as C,N as K,n as h,l as Q,T as D,m as G,R as I,c as w,h as m,u as V,F as U,g as z,a2 as O,a1 as B}from"./app-8631d0ed.js";import{_ as j}from"./ActionSection-29bb69bd.js";import{a as J}from"./DialogModal-cfec345b.js";import{_ as L}from"./InputError-7a875e54.js";import{_ as A}from"./PrimaryButton-9f83ec13.js";import{_ as T}from"./SecondaryButton-641ff84c.js";import{_ as M}from"./TextInput-c4d1940e.js";import{_ as W}from"./DangerButton-03fa1d82.js";import{_ as X}from"./InputLabel-7ab20a25.js";import"./SectionTitle-d97ce962.js";const Y={class:"mt-4"},x={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirmar Contraseña"},content:{type:String,default:"Por su seguridad, confirme su contraseña para continuar."},button:{type:String,default:"Confirmar"}},emits:["confirmed"],setup(b,{emit:S}){const d=S,s=g(!1),o=q({password:"",error:"",processing:!1}),p=g(null),_=()=>{axios.get(route("password.confirmation")).then(i=>{i.data.confirmed?d("confirmed"):(s.value=!0,setTimeout(()=>p.value.focus(),250))})},v=()=>{o.processing=!0,axios.post(route("password.confirm"),{password:o.password}).then(()=>{o.processing=!1,u(),Q().then(()=>d("confirmed"))}).catch(i=>{o.processing=!1,o.error=i.response.data.errors.password[0],p.value.focus()})},u=()=>{s.value=!1,o.password="",o.error=""};return(i,y)=>(t(),r("span",null,[c("span",{onClick:_},[E(i.$slots,"default")]),n(J,{show:s.value,onClose:u},{title:a(()=>[l(C(b.title),1)]),content:a(()=>[l(C(b.content)+" ",1),c("div",Y,[n(M,{ref_key:"passwordInput",ref:p,modelValue:o.password,"onUpdate:modelValue":y[0]||(y[0]=F=>o.password=F),type:"password",class:"mt-1 block w-full",placeholder:"Contraseña",autocomplete:"current-password",onKeyup:K(v,["enter"])},null,8,["modelValue"]),n(L,{message:o.error,class:"mt-2"},null,8,["message"])])]),footer:a(()=>[n(T,{onClick:u},{default:a(()=>[...y[1]||(y[1]=[l(" Cancelar ",-1)])]),_:1}),n(A,{class:h(["ml-3",{"opacity-25":o.processing}]),disabled:o.processing,onClick:v},{default:a(()=>[l(C(b.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},Z={key:0,class:"text-lg font-medium text-gray-900"},ee={key:1,class:"text-lg font-medium text-gray-900"},te={key:2,class:"text-lg font-medium text-gray-900"},ae={key:3},oe={key:0},se={class:"mt-4 max-w-xl text-sm text-gray-600"},re={key:0,class:"font-semibold"},ne={key:1},le=["innerHTML"],ie={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},ce={class:"font-semibold"},de=["innerHTML"],ue={key:1,class:"mt-4"},me={key:1},fe={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},pe={class:"mt-5"},ve={key:0},ge={key:1},Fe={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(b){const S=b,d=g(!1),s=g(!1),o=g(!1),p=g(null),_=g(null),v=g([]),u=D({code:""}),i=G(()=>{var f;return!d.value&&((f=O().props.auth.user)==null?void 0:f.two_factor_enabled)});I(i,()=>{i.value||(u.reset(),u.clearErrors())});const y=()=>{d.value=!0,B.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([F(),R(),$()]),onFinish:()=>{d.value=!1,s.value=S.requiresConfirmation}})},F=()=>axios.get(route("two-factor.qr-code")).then(f=>{p.value=f.data.svg}),R=()=>axios.get(route("two-factor.secret-key")).then(f=>{_.value=f.data.secretKey}),$=()=>axios.get(route("two-factor.recovery-codes")).then(f=>{v.value=f.data}),P=()=>{u.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{s.value=!1,p.value=null,_.value=null}})},H=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>$())},N=()=>{o.value=!0,B.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{o.value=!1,s.value=!1}})};return(f,e)=>(t(),w(j,null,{title:a(()=>[...e[1]||(e[1]=[l(" Autenticación de dos factores ",-1)])]),description:a(()=>[...e[2]||(e[2]=[l(" Agregue seguridad adicional a su cuenta mediante la autenticación de dos factores. ",-1)])]),content:a(()=>[i.value&&!s.value?(t(),r("h3",Z," Ha habilitado la autenticación de dos factores. ")):i.value&&s.value?(t(),r("h3",ee," Termine de habilitar la autenticación de dos factores. ")):(t(),r("h3",te," No ha habilitado la autenticación de dos factores. ")),e[11]||(e[11]=c("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[c("p",null," Cuando la autenticación de dos factores está habilitada, se le solicitará un token seguro y aleatorio durante la autenticación. Puede recuperar este token de la aplicación Google Authenticator de su teléfono. ")],-1)),i.value?(t(),r("div",ae,[p.value?(t(),r("div",oe,[c("div",se,[s.value?(t(),r("p",re," Para terminar de habilitar la autenticación de dos factores, escanee el siguiente código QR usando la aplicación de autenticación de su teléfono o ingrese la clave de configuración y proporcione el código OTP generado. ")):(t(),r("p",ne," La autenticación de dos factores ahora está habilitada. Escanee el siguiente código QR usando la aplicación de autenticación de su teléfono o ingrese la clave de configuración. "))]),c("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:p.value},null,8,le),_.value?(t(),r("div",ie,[c("p",ce,[e[3]||(e[3]=l(" Clave de configuración: ",-1)),c("span",{innerHTML:_.value},null,8,de)])])):m("",!0),s.value?(t(),r("div",ue,[n(X,{for:"code",value:"Codigo"}),n(M,{id:"code",modelValue:V(u).code,"onUpdate:modelValue":e[0]||(e[0]=k=>V(u).code=k),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:K(P,["enter"])},null,8,["modelValue"]),n(L,{message:V(u).errors.code,class:"mt-2"},null,8,["message"])])):m("",!0)])):m("",!0),v.value.length>0&&!s.value?(t(),r("div",me,[e[4]||(e[4]=c("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[c("p",{class:"font-semibold"}," Guarde estos códigos de recuperación en un administrador de contraseñas seguro. Se pueden usar para recuperar el acceso a su cuenta si se pierde su dispositivo de autenticación de dos factores. ")],-1)),c("div",fe,[(t(!0),r(U,null,z(v.value,k=>(t(),r("div",{key:k},C(k),1))),128))])])):m("",!0)])):m("",!0),c("div",pe,[i.value?(t(),r("div",ge,[n(x,{onConfirmed:P},{default:a(()=>[s.value?(t(),w(A,{key:0,type:"button",class:h(["mr-3",{"opacity-25":d.value}]),disabled:d.value},{default:a(()=>[...e[6]||(e[6]=[l(" Confirmar ",-1)])]),_:1},8,["class","disabled"])):m("",!0)]),_:1}),n(x,{onConfirmed:H},{default:a(()=>[v.value.length>0&&!s.value?(t(),w(T,{key:0,class:"mr-3"},{default:a(()=>[...e[7]||(e[7]=[l(" Regenerar códigos de recuperación ",-1)])]),_:1})):m("",!0)]),_:1}),n(x,{onConfirmed:$},{default:a(()=>[v.value.length===0&&!s.value?(t(),w(T,{key:0,class:"mr-3"},{default:a(()=>[...e[8]||(e[8]=[l(" Mostrar códigos de recuperación ",-1)])]),_:1})):m("",!0)]),_:1}),n(x,{onConfirmed:N},{default:a(()=>[s.value?(t(),w(T,{key:0,class:h({"opacity-25":o.value}),disabled:o.value},{default:a(()=>[...e[9]||(e[9]=[l(" Cancelar ",-1)])]),_:1},8,["class","disabled"])):m("",!0)]),_:1}),n(x,{onConfirmed:N},{default:a(()=>[s.value?m("",!0):(t(),w(W,{key:0,class:h({"opacity-25":o.value}),disabled:o.value},{default:a(()=>[...e[10]||(e[10]=[l(" Desactivar ",-1)])]),_:1},8,["class","disabled"]))]),_:1})])):(t(),r("div",ve,[n(x,{onConfirmed:y},{default:a(()=>[n(A,{type:"button",class:h({"opacity-25":d.value}),disabled:d.value},{default:a(()=>[...e[5]||(e[5]=[l(" Activar ",-1)])]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{Fe as default};
