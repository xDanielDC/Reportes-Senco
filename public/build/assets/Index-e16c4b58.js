import{p as R,a3 as T,L as D,O as N,o as s,c as x,w as m,a as l,H as k,b as i,u as n,i as S,f as w,k as F,e as o,g as c,t as u,F as f,aj as P,n as b,h as p}from"./app-8631d0ed.js";import{_ as W}from"./AppLayout-deca06e6.js";import{_ as L}from"./PrimaryButton-9f83ec13.js";import{_ as j}from"./SecondaryButton-641ff84c.js";import{a as z}from"./DialogModal-cfec345b.js";import{_ as $}from"./TextInput-c4d1940e.js";import{r as C,a as A,e as G,m as V,u as H}from"./i18n-validators-bc3fab5c.js";import{_}from"./InputLabel-7ab20a25.js";import{_ as U}from"./Checkbox-41e6bf30.js";import{_ as K}from"./CustomButton-4ddc4f19.js";const Z={class:"py-10"},J={class:"max-w-8xl sm:px-4 lg:px-6"},Q={class:"text-center flex flex-row"},X={class:"badge badge-success"},Y={class:"badge badge-success"},ee={class:"badge badge-success"},se={class:"mt-4"},re={class:"mt-4"},oe={key:0,class:"mt-1"},te={class:"mt-4"},ae={key:0,class:"mt-1"},le={class:"mt-4"},ie={key:0,class:"mt-1"},ne={key:0,class:"block mt-4"},de={class:"flex items-center"},me={key:1,class:"mt-4"},ue={key:0,class:"mt-1"},ce={class:"mt-4"},fe={class:"grid grid-cols-3 gap-5 mt-2"},pe={class:"flex items-center"},_e={class:"ml-2"},ge={key:0,class:"mt-1"},ve={class:"mt-4"},he={class:"grid grid-cols-3 gap-5 mt-2"},ye={class:"flex items-center"},xe={class:"ml-2"},ke={key:0,class:"mt-1"},we={class:"mt-4"},be={class:"grid grid-cols-3 gap-5 mt-2"},$e={class:"flex items-center"},Ce={class:"ml-2"},Ve={key:0,class:"mt-1"},Te={__name:"Index",props:{users:{type:Array,default:[]},roles:{type:Array,default:[]},permissions:{type:Array,default:[]},reports:{type:Array,default:[]}},setup(y){const v=R({data:y.users,columns:["actions","name","username","email","roles","permissions","reports","created_at","updated_at"],options:{headings:{actions:"",name:"NOMBRE",username:"USUARIO",email:"CORREO ELECTRÓNICO",roles:"ROLES",permissions:"PERMISOS",reports:"REPORTES",created_at:"CREADO EL",updated_at:"ACTUALIZADO EL"},clientSorting:!1,uniqueKey:"id",sortable:["name","username","email"]}}),r=R({open:!1,editMode:!1,title:"",form:{id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",reports:[],permissions:[],roles:[]}}),I={form:{id:{requiredIf:C(r.editMode)},name:{required:A},username:{required:A},email:{required:A,email:G},password:{requiredIf:C(r.form.change_password||!r.editMode),minLength:V(8)},reports:{minLength:V(1)},permissions:{requiredIf:C(r.form.roles.length<1),minLength:V(1)},roles:{requiredIf:C(r.form.permissions.length<1),minLength:V(1)}}},d=H(I,T(r)),O=()=>{r.open=!0,r.title="Crear Usuario"},q=()=>{r.open=!1,r.title="",r.form={id:"",type:"",name:"",username:"",email:"",change_password:!1,password:"",reports:[],permissions:[],roles:[]},d.value.form.$reset()},B=()=>{d.value.form.$touch(),d.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.post(route("users.store"),r.form).then(g=>{q(),v.data=g.data}).catch(g=>{Swal.fire({icon:"error",title:"¡Whoops!",text:g.response.data,confirmButtonText:"Aceptar"})})},M=g=>{Swal.fire({icon:"question",title:"¿Eliminar Usuario?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(t=>{t.isConfirmed&&axios.delete(route("users.destroy",g)).then(h=>{v.data=h.data}).catch(h=>{Swal.fire({icon:"error",title:"¡Whoops!",text:h.response.data,confirmButtonText:"Aceptar"})})})};return(g,t)=>{const h=D("v-client-table"),E=N("permission");return s(),x(W,{title:"Usuarios del sistema"},{header:m(()=>[...t[9]||(t[9]=[l("div",{class:"flex flex-row"},[l("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Usuarios del sistema ")],-1)])]),actions:m(()=>[k((s(),x(L,{class:"ml-auto",type:"button",onClick:O},{default:m(()=>[i(n(S),{class:"mr-2",icon:"plus"}),t[10]||(t[10]=w(" Crear ",-1))]),_:1})),[[E,"user.create"]])]),default:m(()=>[l("div",Z,[l("div",J,[i(h,{columns:v.columns,data:v.data,options:v.options,class:"overflow-y-auto"},{actions:m(({row:e})=>[l("div",Q,[k((s(),x(n(F),{href:g.route("users.show",e.id),class:"mr-2 inline-flex items-center px-2 py-2 bg-white border border-gray-300 rounded-md font-semibold text-xs text-gray-700 uppercase tracking-widest shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-25 transition ease-in-out duration-150"},{default:m(()=>[i(n(S),{icon:["far","pen-to-square"]})]),_:1},8,["href"])),[[E,"user.edit"]]),k((s(),x(K,{onClick:a=>M(e.id)},{default:m(()=>[i(n(S),{icon:["far","trash-can"]})]),_:1},8,["onClick"])),[[E,"user.destroy"]])])]),roles:m(({row:e})=>[(s(!0),o(f,null,c(e.roles,a=>(s(),o("span",X,u(a.name),1))),256))]),permissions:m(({row:e})=>[(s(!0),o(f,null,c(e.permission_names,a=>(s(),o("span",Y,u(a),1))),256))]),reports:m(({row:e})=>[(s(!0),o(f,null,c(e.reports,a=>(s(),o("span",ee,u(a.name),1))),256))]),_:1},8,["columns","data","options"])])]),i(z,{show:r.open,onClose:q},{title:m(()=>[w(u(r.title),1)]),content:m(()=>[l("div",se,[i(_,{value:"Tipo"}),k(l("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.form.type=e),class:"border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm mt-1 block w-full",required:""},[...t[11]||(t[11]=[l("option",{disabled:"",selected:"",value:""},"Seleccione…",-1),l("option",{value:"customer"},"Cliente",-1),l("option",{value:"designer"},"Diseñador",-1)])],512),[[P,r.form.type]])]),l("div",re,[i(_,{value:"Nombre"}),i($,{modelValue:r.form.name,"onUpdate:modelValue":t[1]||(t[1]=e=>r.form.name=e),class:b([{"border-red-500":n(d).form.name.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"text"},null,8,["modelValue","class"]),n(d).form.name.$error?(s(),o("ul",oe,[(s(!0),o(f,null,c(n(d).form.name.$errors,(e,a)=>(s(),o("li",{key:a,class:"text-red-500"},u(e.$message),1))),128))])):p("",!0)]),l("div",te,[i(_,{value:"Usuario"}),i($,{modelValue:r.form.username,"onUpdate:modelValue":t[2]||(t[2]=e=>r.form.username=e),class:b([{"border-red-500":n(d).form.username.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"text"},null,8,["modelValue","class"]),n(d).form.username.$error?(s(),o("ul",ae,[(s(!0),o(f,null,c(n(d).form.username.$errors,(e,a)=>(s(),o("li",{key:a,class:"text-red-500"},u(e.$message),1))),128))])):p("",!0)]),l("div",le,[i(_,{value:"Correo electrónico"}),i($,{modelValue:r.form.email,"onUpdate:modelValue":t[3]||(t[3]=e=>r.form.email=e),class:b([{"border-red-500":n(d).form.email.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"email"},null,8,["modelValue","class"]),n(d).form.email.$error?(s(),o("ul",ie,[(s(!0),o(f,null,c(n(d).form.email.$errors,(e,a)=>(s(),o("li",{key:a,class:"text-red-500"},u(e.$message),1))),128))])):p("",!0)]),r.editMode?(s(),o("div",ne,[l("label",de,[i(U,{checked:r.form.change_password,"onUpdate:checked":t[4]||(t[4]=e=>r.form.change_password=e),name:"change_password"},null,8,["checked"]),t[12]||(t[12]=l("span",{class:"ml-2 text-sm text-gray-600"},"Cambiar contraseña",-1))])])):p("",!0),r.form.change_password||!r.editMode?(s(),o("div",me,[i(_,{value:"Contraseña"}),i($,{modelValue:r.form.password,"onUpdate:modelValue":t[5]||(t[5]=e=>r.form.password=e),class:b([{"border-red-500":n(d).form.password.$error},"mt-1 block w-full"]),autocomplete:"off",required:"",type:"password"},null,8,["modelValue","class"]),n(d).form.password.$error?(s(),o("ul",ue,[(s(!0),o(f,null,c(n(d).form.password.$errors,(e,a)=>(s(),o("li",{key:a,class:"text-red-500"},u(e.$message),1))),128))])):p("",!0)])):p("",!0),l("div",ce,[i(_,{value:"Reportes disponibles"}),l("div",fe,[(s(!0),o(f,null,c(y.reports,e=>(s(),o("div",pe,[i(U,{checked:r.form.reports,"onUpdate:checked":t[6]||(t[6]=a=>r.form.reports=a),value:e.id},null,8,["checked","value"]),l("div",_e,u(e.name),1)]))),256))]),n(d).form.reports.$error?(s(),o("ul",ge,[(s(!0),o(f,null,c(n(d).form.reports.$errors,(e,a)=>(s(),o("li",{key:a,class:"text-red-500"},u(e.$message),1))),128))])):p("",!0)]),l("div",ve,[i(_,{value:"Roles Disponibles"}),l("div",he,[(s(!0),o(f,null,c(y.roles,e=>(s(),o("div",ye,[i(U,{checked:r.form.roles,"onUpdate:checked":t[7]||(t[7]=a=>r.form.roles=a),value:e.name},null,8,["checked","value"]),l("div",xe,u(e.name),1)]))),256))]),n(d).form.roles.$error?(s(),o("ul",ke,[(s(!0),o(f,null,c(n(d).form.roles.$errors,(e,a)=>(s(),o("li",{key:a,class:"text-red-500"},u(e.$message),1))),128))])):p("",!0)]),l("div",we,[i(_,{value:"Permisos Disponibles"}),l("div",be,[(s(!0),o(f,null,c(y.permissions,e=>(s(),o("div",$e,[i(U,{checked:r.form.permissions,"onUpdate:checked":t[8]||(t[8]=a=>r.form.permissions=a),value:e.name},null,8,["checked","value"]),l("div",Ce,u(e.name),1)]))),256))]),n(d).form.permissions.$error?(s(),o("ul",Ve,[(s(!0),o(f,null,c(n(d).form.permissions.$errors,(e,a)=>(s(),o("li",{key:a,class:"text-red-500"},u(e.$message),1))),128))])):p("",!0)])]),footer:m(()=>[i(j,{onClick:q},{default:m(()=>[...t[13]||(t[13]=[w(" Cancelar ",-1)])]),_:1}),i(L,{class:"ml-3",onClick:B},{default:m(()=>[...t[14]||(t[14]=[w(" Guardar ",-1)])]),_:1})]),_:1},8,["show"])]),_:1})}}};export{Te as default};
