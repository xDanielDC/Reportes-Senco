import{_ as N}from"./AppLayout-1872c1d6.js";import{_ as g}from"./PrimaryButton-53fc1b09.js";import{_ as I}from"./SecondaryButton-4187b912.js";import{a as W}from"./DialogModal-ba4ec678.js";import{_ as O}from"./TextInput-67026b5f.js";import{r as F,a as w,m as U,u as z}from"./i18n-validators-63d8612e.js";import{_ as A}from"./InputLabel-8586db4c.js";import{_ as P}from"./Checkbox-4f738b6a.js";import{_ as B}from"./CustomButton-9f2275fd.js";import{p as S,a5 as E,a2 as G,I as K,L as Z,o,c as f,w as s,D as y,b as n,u as d,i as C,f as _,a as m,e as l,g as v,t as h,F as $,n as j,h as R}from"./app-e23bdcff.js";const H=m("div",{class:"flex flex-row"},[m("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Roles ")],-1),J={class:"py-10"},Q={class:"max-w-8xl sm:px-4 lg:px-6"},X={class:"text-center flex flex-row"},Y={class:"badge badge-success"},ee={class:"mt-4"},te={key:0,class:"mt-1"},oe={class:"mt-4"},se={class:"grid grid-cols-3 gap-5 mt-2"},ae={class:"flex items-center"},re={class:"ml-2"},ie={key:0,class:"mt-1"},$e={__name:"Roles",props:{roles:{type:Array,default:[]},permissions:{type:Array,default:[]}},setup(b){const u=S({data:b.roles,columns:["actions","name","permissions","created_at","updated_at"],options:{headings:{actions:"",name:"NOMBRE",permissions:"PERMISOS",created_at:"CREADO EL",updated_at:"ACTUALIZADO EL"},clientSorting:!1,uniqueKey:"id",sortable:["description"],templates:{created_at(t,r){return E.formatDate(r.created_at)},updated_at(t,r){return E.formatDate(r.updated_at)}}}}),e=S({open:!1,editMode:!1,title:"",form:{id:"",name:"",permissions:[]}}),V={form:{id:{requiredIf:F(e.editMode)},name:{required:w},permissions:{required:w,minLength:U(1)}}},i=z(V,G(e)),q=()=>{e.open=!0,e.title="Crear Rol"},D=t=>{e.open=!0,e.editMode=!0,e.title="Editar Rol",e.form={id:t.id,name:t.name,permissions:t.permissions.map(r=>r.name)}},x=()=>{e.open=!1,e.editMode=!1,e.title="",e.form={id:"",name:"",permissions:[]},i.value.form.$reset()},M=()=>{i.value.form.$touch(),i.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.post(route("roles.store"),e.form).then(t=>{x(),u.data=t.data}).catch(t=>{Swal.fire({icon:"error",title:"¡Whoops!",text:t.response.data,confirmButtonText:"Aceptar"})})},T=()=>{i.value.form.$touch(),i.value.form.$invalid?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):axios.put(route("roles.update",e.form.id),e.form).then(t=>{x(),u.data=t.data}).catch(t=>{Swal.fire({icon:"error",title:"¡Whoops!",text:t.response.data,confirmButtonText:"Aceptar"})})},L=t=>{Swal.fire({icon:"question",title:"¿Eliminar Rol?",text:"¡Esta acción no es reversible!",showCancelButton:!0,confirmButtonText:"¡Si, Eliminar!"}).then(r=>{r.isConfirmed&&axios.delete(route("roles.destroy",t)).then(p=>{u.data=p.data}).catch(p=>{Swal.fire({icon:"error",title:"¡Whoops!",text:p.response.data,confirmButtonText:"Aceptar"})})})};return(t,r)=>{const p=K("v-client-table"),k=Z("permission");return o(),f(N,{title:"Roles"},{header:s(()=>[H]),actions:s(()=>[y((o(),f(g,{type:"button",onClick:q},{default:s(()=>[n(d(C),{class:"mr-2",icon:"plus"}),_(" Crear ")]),_:1})),[[k,"role.create"]])]),default:s(()=>[m("div",J,[m("div",Q,[n(p,{columns:u.columns,data:u.data,options:u.options,class:"overflow-y-auto"},{actions:s(({row:a})=>[m("div",X,[y((o(),f(B,{class:"mr-2",onClick:c=>D(a)},{default:s(()=>[n(d(C),{icon:["far","pen-to-square"]})]),_:2},1032,["onClick"])),[[k,"role.edit"]]),y((o(),f(B,{onClick:c=>L(a.id)},{default:s(()=>[n(d(C),{icon:["far","trash-can"]})]),_:2},1032,["onClick"])),[[k,"role.destroy"]])])]),permissions:s(({row:a})=>[(o(!0),l($,null,v(a.permissions,(c,le)=>(o(),l("span",Y,h(c.name),1))),256))]),_:1},8,["columns","data","options"])])]),n(W,{show:e.open,onClose:x},{title:s(()=>[_(h(e.title),1)]),content:s(()=>[m("div",ee,[n(A,{value:"Nombre"}),n(O,{modelValue:e.form.name,"onUpdate:modelValue":r[0]||(r[0]=a=>e.form.name=a),class:j([{"border-red-500":d(i).form.name.$error},"mt-1 block w-full"]),autocomplete:"Nombre",required:"",type:"text"},null,8,["modelValue","class"]),d(i).form.name.$error?(o(),l("ul",te,[(o(!0),l($,null,v(d(i).form.name.$errors,(a,c)=>(o(),l("li",{key:c,class:"text-red-500"},h(a.$message),1))),128))])):R("",!0)]),m("div",oe,[n(A,{value:"Permisos Disponibles"}),m("div",se,[(o(!0),l($,null,v(b.permissions,a=>(o(),l("div",ae,[n(P,{checked:e.form.permissions,"onUpdate:checked":r[1]||(r[1]=c=>e.form.permissions=c),value:a.name},null,8,["checked","value"]),m("div",re,h(a.name),1)]))),256))]),d(i).form.permissions.$error?(o(),l("ul",ie,[(o(!0),l($,null,v(d(i).form.permissions.$errors,(a,c)=>(o(),l("li",{key:c,class:"text-red-500"},h(a.$message),1))),128))])):R("",!0)])]),footer:s(()=>[n(I,{onClick:x},{default:s(()=>[_(" Cancelar ")]),_:1}),e.editMode?(o(),f(g,{key:0,class:"ml-3",onClick:T},{default:s(()=>[_(" Actualizar ")]),_:1})):(o(),f(g,{key:1,class:"ml-3",onClick:M},{default:s(()=>[_(" Guardar ")]),_:1}))]),_:1},8,["show"])]),_:1})}}};export{$e as default};
