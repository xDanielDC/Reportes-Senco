import{p as h,a3 as C,L as R,o as i,e as c,b as r,u as d,Z as U,a as e,i as T,t as a,w as m,f,F as v,g as w,H as k,a0 as S,n as Y,h as $,a6 as F}from"./app-8631d0ed.js";import{_ as P}from"./PrimaryButton-9f83ec13.js";import{n as B,a as E,m as y,b as z,h as M,u as A}from"./i18n-validators-bc3fab5c.js";import{L as j}from"./Main-221fbb65.js";import{_ as q}from"./CustomButton-4ddc4f19.js";import{a as G}from"./DialogModal-cfec345b.js";import{_ as W}from"./SecondaryButton-641ff84c.js";import{_ as H}from"./Checkbox-41e6bf30.js";const K={class:"min-h-screen bg-gray-100"},Q={class:"py-10 content-center"},Z={class:"max-w-7xl mx-auto"},J={class:"grid grid-cols-2 gap-5 mb-10"},X={class:"flex items-center px-4 py-4 box"},ee={class:"flex-none overflow-hidden rounded-md image-fit items-center justify-center text-slate-700"},te={class:"ml-4 mr-auto"},se={class:"font-medium"},oe={class:"flex items-center px-4 py-4 box"},re={class:"flex-none overflow-hidden rounded-md image-fit items-center justify-center text-slate-700"},ae={class:"ml-4 mr-auto"},ne={class:"font-medium"},le={class:"text-center"},ie={class:"overflow-y-auto"},ce={class:"table table-sm table-bordered"},de={class:"text-right"},ue={class:"text-right"},me={class:"text-right"},pe=["onUpdate:modelValue"],_e={key:0,class:"mt-1"},he={key:0,class:"mt-1"},De={__name:"Show",props:{registry:Object},setup(g){const N=g,O=h({isCorrect:!1,document:""}),D=h({document:{numeric:B,required:E,minLength:y(9),maxLength:z(9)},row:{registries:{required:E,minLength:y(1),$each:M.forEach({DELIVERY_DATE:{required:E},COMMITTED_AMOUNT:{required:E,minValue:M.withMessage(()=>"No puede ser menor o igual a 0",o=>0<=o),maxValue:M.withMessage(()=>"No puede ser mayor a la cantidad pendiente",(o,{PENDING_AMOUNT:s})=>o<=s)}})}}}),_=h({data:N.registry.orders,columns:["oc","delivery_date","actions"],options:{headings:{oc:"OC",delivery_date:"FECHA ENTREGA",actions:""},clientSorting:!1,uniqueKey:"id",sortable:["oc","delivery_date"]}}),n=h({open:!1,row:{}}),b=()=>{n.open=!1,n.row={}},V=o=>{n.open=!0,n.row=o};A(D,C(O));const u=A(D,C(n)),I=()=>{u.value.$touch(),u.value.$invalid||!n.row.registries.some(o=>o.SELECTED===!0)?Swal.fire({icon:"error",title:"¡Whoops!",text:"Verifica que toda la información este correctamente diligenciada",confirmButtonText:"Aceptar"}):(F.Loading(),axios.post(route("supplier-delivery.update"),n.row).then(o=>{_.data=o.data,Swal.fire({icon:"error",title:"¡Éxito!",text:"Registro actualizado con éxito",confirmButtonText:"Aceptar"})}).catch(o=>{Swal.fire({icon:"error",title:"¡Whoops!",text:o.response.data,confirmButtonText:"Aceptar"})}))};return(o,s)=>{const L=R("v-client-table");return i(),c("div",null,[r(d(U),{title:"Registro"}),e("div",K,[e("div",Q,[e("div",Z,[e("div",J,[e("div",X,[e("div",ee,[r(d(T),{icon:"user",size:"2xl"})]),e("div",te,[e("div",se,a(g.registry.supplier.name),1),s[0]||(s[0]=e("div",{class:"text-slate-500 text-xs mt-0.5"},"Razon Social",-1))])]),e("div",oe,[e("div",re,[r(d(T),{icon:"user",size:"2xl"})]),e("div",ae,[e("div",ne,a(g.registry.supplier.document),1),s[1]||(s[1]=e("div",{class:"text-slate-500 text-xs mt-0.5"},"NIT",-1))])])]),r(L,{columns:_.columns,data:_.data,options:_.options,class:"overflow-y-auto w-full"},{actions:m(({row:t})=>[e("div",le,[r(q,{type:"button",onClick:p=>V(t)},{default:m(()=>[r(d(T),{class:"mr-2",icon:"plus"}),s[2]||(s[2]=f(" Registrar entrega ",-1))]),_:1},8,["onClick"])])]),_:1},8,["columns","data","options"])])]),r(G,{show:n.open,onClose:b,"max-width":"7xl"},{title:m(()=>[f(" ORDEN DE COMPRA #"+a(n.row.oc),1)]),content:m(()=>[e("div",ie,[e("table",ce,[s[3]||(s[3]=e("thead",null,[e("tr",{class:"text-center"},[e("th",{colspan:"3",class:"border-b"}," Producto "),e("th",{colspan:"4",class:"border-b"}," Cantidades "),e("th",{class:"border-b",rowspan:"2"}," Fecha entrega ")]),e("tr",null,[e("th"),e("th",null,"Código"),e("th",null,"Descripción"),e("th",null,"Solicitada"),e("th",null,"Entregada"),e("th",null,"Pendiente"),e("th",null,"Compromiso")])],-1)),e("tbody",null,[(i(!0),c(v,null,w(n.row.registries,(t,p)=>(i(),c("tr",null,[e("td",null,[r(H,{checked:t.SELECTED,"onUpdate:checked":l=>t.SELECTED=l,name:"remember"},null,8,["checked","onUpdate:checked"])]),e("td",null,a(t.ITEM),1),e("td",null,a(t.PRODUCT_DESCRIPTION)+" – "+a(t.MEASUREMENT),1),e("td",de,a(parseFloat(t.REQUESTED_AMOUNT)),1),e("td",ue,a(parseFloat(t.RECEIVED_AMOUNT)),1),e("td",me,a(parseFloat(t.PENDING_AMOUNT)),1),e("td",null,[k(e("input",{type:"number",class:Y(["form-control form-control-sm",{"border-red-500":d(u).row.registries.$each.$response.$errors[p].COMMITTED_AMOUNT.length>0}]),"onUpdate:modelValue":l=>t.COMMITTED_AMOUNT=l},null,10,pe),[[S,t.COMMITTED_AMOUNT]]),d(u).row.registries.$each.$response.$errors[p].COMMITTED_AMOUNT.length>0?(i(),c("ul",_e,[(i(!0),c(v,null,w(d(u).row.registries.$each.$response.$errors[p].COMMITTED_AMOUNT,(l,x)=>(i(),c("li",{key:x,class:"text-red-600"},a(l.$message),1))),128))])):$("",!0)]),e("td",null,[r(j,{modelValue:t.DELIVERY_DATE,"onUpdate:modelValue":l=>t.DELIVERY_DATE=l,options:{autoApply:!0,singleMode:!0,numberOfColumns:1,numberOfMonths:1,showWeekNumbers:!0,format:"DD-MM-YYYY",lang:"es-ES",minDate:t.DELIVERY_DATE},class:"form-control form-control-sm"},null,8,["modelValue","onUpdate:modelValue","options"]),d(u).row.registries.$each.$response.$errors[p].DELIVERY_DATE.length>0?(i(),c("ul",he,[(i(!0),c(v,null,w(d(u).row.registries.$each.$response.$errors[p].DELIVERY_DATE,(l,x)=>(i(),c("li",{key:x,class:"text-red-600"},a(l.$message),1))),128))])):$("",!0)])]))),256))])])])]),footer:m(()=>[r(W,{onClick:b},{default:m(()=>[...s[4]||(s[4]=[f(" Cancelar ",-1)])]),_:1}),r(P,{class:"ml-3",onClick:I},{default:m(()=>[...s[5]||(s[5]=[f(" Guardar ",-1)])]),_:1})]),_:1},8,["show"])])])}}};export{De as default};
